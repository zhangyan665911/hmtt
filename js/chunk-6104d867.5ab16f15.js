(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6104d867"],{"669d":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("van-nav-bar",{attrs:{title:"编辑信息","left-arrow":"","right-text":"保存"},on:{"click-left":function(t){return e.$router.back()},"click-right":e.saveUserProfile}}),n("van-cell-group",[n("van-cell",{attrs:{"is-link":"",title:"头像",center:""}},[n("van-image",{attrs:{round:"",width:"1.5rem",height:"1.5rem",src:e.user.photo,fit:"cover"},on:{click:e.openImagePopup}})],1),n("van-cell",{attrs:{"is-link":"",title:"名称",value:e.user.name},on:{click:e.openName}}),n("van-cell",{attrs:{"is-link":"",title:"性别",value:0==e.user.gender?"男":"女"},on:{click:e.openGender}}),n("van-cell",{attrs:{"is-link":"",title:"生日",value:e.user.birthday},on:{click:e.openBirthday}})],1),n("van-popup",{staticStyle:{width:"80%"},model:{value:e.showImage,callback:function(t){e.showImage=t},expression:"showImage"}},[n("van-cell",{attrs:{"is-link":"",title:"本地相册选择图片"},on:{click:e.selectFromLocal}}),n("van-cell",{attrs:{"is-link":"",title:"拍照"}})],1),n("van-popup",{staticStyle:{width:"80%"},attrs:{"close-on-click-overlay":!1},model:{value:e.showName,callback:function(t){e.showName=t},expression:"showName"}},[n("van-field",{attrs:{"error-message":e.errorNameMsg,type:"textarea",placeholder:"请输入用户名"},model:{value:e.user.name,callback:function(t){e.$set(e.user,"name","string"===typeof t?t.trim():t)},expression:"user.name"}}),n("van-button",{attrs:{type:"info",size:"large"},on:{click:e.closeName}},[e._v(" 确定")])],1),n("van-action-sheet",{attrs:{actions:e.actions,"cancel-text":"取消"},on:{select:e.changeGender},model:{value:e.showGender,callback:function(t){e.showGender=t},expression:"showGender"}}),n("van-popup",{attrs:{position:"bottom"},model:{value:e.showBirthday,callback:function(t){e.showBirthday=t},expression:"showBirthday"}},[n("van-datetime-picker",{attrs:{type:"date","min-date":e.minDate,"max-date":e.maxDate},on:{confirm:e.confirmBirthday},model:{value:e.currentDate,callback:function(t){e.currentDate=t},expression:"currentDate"}})],1),n("input",{ref:"file",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:e.getFile}})],1)},a=[],o=(n("a4d3"),n("4de4"),n("4160"),n("b0c0"),n("e439"),n("dbb4"),n("b64b"),n("159b"),n("96cf"),n("1da1")),i=n("ade3"),c=n("5a0c"),s=n.n(c),u=n("c24f"),l=n("2f62");function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){Object(i["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p={data:function(){return{showImage:!1,showName:!1,showGender:!1,showBirthday:!1,user:{name:"",gender:0,birthday:""},errorNameMsg:"",actions:[{name:"男"},{name:"女"}],minDate:new Date(1900,1,1),maxDate:new Date,currentDate:new Date}},created:function(){this.getUserProfile()},methods:f({},Object(l["b"])(["updatePhoto"]),{getUserProfile:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["b"])();case 2:t=e.sent,this.user=t;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),openImagePopup:function(){this.showImage=!0},selectFromLocal:function(){this.$refs.file.click()},getFile:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=new FormData,t.append("photo",this.$refs.file.files[0]),e.next=4,Object(u["g"])(t);case 4:n=e.sent,this.user.photo=n.photo,this.updatePhoto({photo:this.user.photo}),this.showImage=!1;case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),openName:function(){this.showName=!0},closeName:function(){if(this.user.name.length<1||this.user.name.length>7)return this.errorNameMsg="用户名的长度必须是1-7位",!1;this.errorNameMsg="",this.showName=!1},openGender:function(){this.showGender=!0},changeGender:function(e,t){"男"===e.name?this.user.gender=0:this.user.gender=1,this.showGender=!1},openBirthday:function(){this.currentDate=new Date(this.user.birthday),this.showBirthday=!0},confirmBirthday:function(e){this.user.birthday=s()(e).format("YYYY-MM-DD"),this.showBirthday=!1},saveUserProfile:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(u["f"])(f({},this.user,{photo:null}));case 3:this.$gnotify({type:"success",message:"修改用户信息成功"}),e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),this.$gnotify({type:"danger",message:"保存失败"});case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));function t(){return e.apply(this,arguments)}return t}()})},d=p,m=n("2877"),b=Object(m["a"])(d,r,a,!1,null,"5d08351c",null);t["default"]=b.exports},b0c0:function(e,t,n){var r=n("83ab"),a=n("9bf2").f,o=Function.prototype,i=o.toString,c=/^\s*function ([^ (]*)/,s="name";!r||s in o||a(o,s,{configurable:!0,get:function(){try{return i.call(this).match(c)[1]}catch(e){return""}}})},c24f:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"g",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"f",(function(){return l}));var r=n("b775");function a(e){return Object(r["a"])({url:"authorizations",method:"post",data:e})}function o(e){return Object(r["a"])({url:"/user/followings",method:"post",data:{target:e}})}function i(e){return Object(r["a"])({url:"user/followings/".concat(e),method:"delete"})}function c(){return Object(r["a"])({url:"/user"})}function s(e){return Object(r["a"])({url:"/user/photo",method:"patch",data:e})}function u(){return Object(r["a"])({url:"/user/profile",method:"get"})}function l(e){return Object(r["a"])({url:"/user/profile",method:"patch",data:e})}}}]);
//# sourceMappingURL=chunk-6104d867.5ab16f15.js.map